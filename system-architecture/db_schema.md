## ๐งฉ AdMirror โ Database Schema

**Tech:** PostgreSQL + Prisma ORM (ุฃู SQLAlchemy ุฅุฐุง ูุถูุช FastAPI native)
**ูุจุฏุฃ ุงูุชุตููู:**

* ูุงุจู ููุชูุณุน ุฃููููุง.
* ุฌููุน ุงูุนูุงูุงุช ููุซูุฉ.
* ุงูุงุนุชูุงุฏ ุนูู UUID ูููุงุชูุญ ุฑุฆูุณูุฉ.
* ุฏุนู multi-tenancy (ููู ูุณุชุฎุฏู ุจูุงูุงุชู ูุชุญูููุงุชู ุงูุฎุงุตุฉ).

---

### 1. ุฌุฏูู ุงููุณุชุฎุฏููู (`users`)

| ุงูุญูู           | ุงูููุน                       | ุงููุตู                    |
| --------------- | --------------------------- | ------------------------ |
| `id`            | UUID (PK)                   | ุงููุนุฑู ุงููุฑูุฏ ูููุณุชุฎุฏู   |
| `email`         | VARCHAR(255)                | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงููุฑูุฏ |
| `password_hash` | TEXT                        | ูููุฉ ุงููุฑูุฑ ุจุนุฏ ุงูุชุดููุฑ  |
| `full_name`     | VARCHAR(120)                | ุงุณู ุงููุณุชุฎุฏู             |
| `role`          | ENUM('user','admin')        | ููุน ุงูุญุณุงุจ               |
| `plan`          | ENUM('free','pro','agency') | ุงูุฎุทุฉ ุงูุญุงููุฉ            |
| `created_at`    | TIMESTAMP                   | ุชุงุฑูุฎ ุงูุฅูุดุงุก            |
| `updated_at`    | TIMESTAMP                   | ุขุฎุฑ ุชุนุฏูู                |
| `is_active`     | BOOLEAN                     | ุญุงูุฉ ุงูุญุณุงุจ              |

๐ **ุนูุงูุงุช:**
`users` โถ `ads_generated`, `ai_reports`, `subscriptions`

---

### 2. ุฌุฏูู ุงูุฅุนูุงูุงุช ุงููุณุชูุฑุฏุฉ (`ads_collected`)

| ุงูุญูู             | ุงูููุน                        | ุงููุตู                               |
| ----------------- | ---------------------------- | ----------------------------------- |
| `id`              | UUID (PK)                    | ูุนุฑู ุงูุฅุนูุงู                        |
| `platform`        | ENUM('instagram','facebook') | ุงูููุตุฉ ุงููุตุฏุฑ                       |
| `ad_url`          | TEXT                         | ุฑุงุจุท ุงูุฅุนูุงู                        |
| `page_name`       | VARCHAR(255)                 | ุงุณู ุงูุญุณุงุจ ุงููุนูู                   |
| `category`        | VARCHAR(120)                 | ูุฆุฉ ุงูุฅุนูุงู (ุชุฌูููุ ููุงุจุณ...)       |
| `country`         | VARCHAR(80)                  | ุงูุฏููุฉ ุงููุณุชูุฏูุฉ                    |
| `text_content`    | TEXT                         | ุงููุต ุงููุณุชุฎุฏู ุจุงูุฅุนูุงู              |
| `media_url`       | TEXT                         | ุฑุงุจุท ุงูุตูุฑุฉ ุฃู ุงูููุฏูู              |
| `likes`           | INTEGER                      | ุนุฏุฏ ุงูุฅุนุฌุงุจุงุช                       |
| `comments`        | INTEGER                      | ุนุฏุฏ ุงูุชุนูููุงุช                       |
| `engagement_rate` | FLOAT                        | ูุนุฏู ุงูุชูุงุนู ุงูุชูุฑูุจู               |
| `collected_at`    | TIMESTAMP                    | ุชุงุฑูุฎ ุงูุฌูุจ                         |
| `ai_score`        | FLOAT                        | ุชูููู AdMirror Score (ููุญุฏุซ ูุงุญููุง) |

๐ **ุนูุงูุงุช:**
`ads_collected` โถ `ai_reports`

---

### 3. ุฌุฏูู ุงูุชูุงุฑูุฑ ุงูุชุญููููุฉ (`ai_reports`)

| ุงูุญูู               | ุงูููุน                        | ุงููุตู                       |
| ------------------- | ---------------------------- | --------------------------- |
| `id`                | UUID (PK)                    | ูุนุฑู ุงูุชูุฑูุฑ                |
| `ad_id`             | UUID (FK โ ads_collected.id) | ุงูุฅุนูุงู ุงููุญูู              |
| `user_id`           | UUID (FK โ users.id)         | ุงููุณุชุฎุฏู ุงูุฐู ุทูุจ ุงูุชุญููู   |
| `text_analysis`     | JSONB                        | ุชุญููู ุงููุตูุต                |
| `visual_analysis`   | JSONB                        | ุชุญููู ุงูุตูุฑ ูุงูููุฏูููุงุช     |
| `audience_analysis` | JSONB                        | ุชุญููู ุงูุฌูููุฑ               |
| `strategy_summary`  | TEXT                         | ููุฎุต ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุณููููุฉ |
| `adm_score`         | FLOAT                        | ุชูููู ุฎูุงุฑุฒููุฉ AdMirror     |
| `created_at`        | TIMESTAMP                    | ููุช ุฅูุดุงุก ุงูุชูุฑูุฑ           |

---

### 4. ุฌุฏูู ุงูุฅุนูุงูุงุช ุงููููุฏุฉ (`ads_generated`)

| ุงูุญูู               | ุงูููุน                               | ุงููุตู                         |
| ------------------- | ----------------------------------- | ----------------------------- |
| `id`                | UUID (PK)                           | ูุนุฑู ุงูุฅุนูุงู ุงูุฌุฏูุฏ           |
| `user_id`           | UUID (FK โ users.id)                | ุตุงุญุจ ุงูุทูุจ                    |
| `source_ad_id`      | UUID (FK โ ads_collected.id)        | ุงูุฅุนูุงู ุงูุฃุตูู ุงููุณุชูุญู ููู   |
| `generated_text`    | TEXT                                | ุงููุต ุงููุงุชุฌ                   |
| `hashtags`          | TEXT[]                              | ูุงุฆูุฉ ุงููุงุดุชุงุบุงุช              |
| `media_preview_url` | TEXT                                | ุฑุงุจุท ุงูุตูุฑุฉ ุฃู ุงูููุฏูู ุงููุงุชุฌ |
| `generation_type`   | ENUM('text','image','video','full') | ููุน ุงูุชูููุฏ                   |
| `created_at`        | TIMESTAMP                           | ุชุงุฑูุฎ ุงูุฅูุดุงุก                 |

---

### 5. ุฌุฏูู ุงูุงุดุชุฑุงูุงุช (`subscriptions`)

| ุงูุญูู                | ุงูููุน                               | ุงููุตู                  |
| -------------------- | ----------------------------------- | ---------------------- |
| `id`                 | UUID (PK)                           | ูุนุฑู ุงูุงุดุชุฑุงู          |
| `user_id`            | UUID (FK โ users.id)                | ุงููุณุชุฎุฏู               |
| `stripe_customer_id` | VARCHAR(120)                        | ูุนุฑูู ุงูุนููู ูู Stripe |
| `plan`               | ENUM('free','pro','agency')         | ุงูุฎุทุฉ                  |
| `status`             | ENUM('active','canceled','expired') | ุญุงูุฉ ุงูุงุดุชุฑุงู          |
| `renewal_date`       | TIMESTAMP                           | ุชุงุฑูุฎ ุงูุชุฌุฏูุฏ          |
| `created_at`         | TIMESTAMP                           | ุชุงุฑูุฎ ุงูุงุดุชุฑุงู         |

---

### 6. ุฌุฏูู ุงูุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ (`system_metrics`)

| ุงูุญูู                     | ุงูููุน       | ุงููุตู                   |
| ------------------------- | ----------- | ----------------------- |
| `id`                      | SERIAL (PK) | ุงููุนุฑู                  |
| `total_users`             | INTEGER     | ุนุฏุฏ ุงููุณุชุฎุฏููู ุงูููู    |
| `total_ads_collected`     | INTEGER     | ุนุฏุฏ ุงูุฅุนูุงูุงุช ุงููุณุชูุฑุฏุฉ |
| `total_reports_generated` | INTEGER     | ุนุฏุฏ ุงูุชูุงุฑูุฑ            |
| `total_ads_generated`     | INTEGER     | ุนุฏุฏ ุงูุฅุนูุงูุงุช ุงููุงุชุฌุฉ   |
| `last_update`             | TIMESTAMP   | ุขุฎุฑ ุชุญุฏูุซ ูููุธุงู        |

---

### 7. ุงูุฌุฏุงูู ุงูุฏุงุนูุฉ (Optional)

* **`audit_logs`** โ ูุชุชุจุน ูุดุงุท ุงููุณุชุฎุฏููู.
* **`api_keys`** โ ูู ุญุงู ุงูุณูุงุญ ุจุงุณุชุฎุฏุงู API ุฎุงุฑุฌู.
* **`cache_metadata`** โ ูุฅุฏุงุฑุฉ ุงูู caching ูุงูู rate limits.
